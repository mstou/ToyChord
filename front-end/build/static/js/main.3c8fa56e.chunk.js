(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{19:function(e,t,n){},21:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),s=n(11),r=n.n(s),i=(n(19),n(3)),l=n(4),o=n(1),u=n(6),h=n(5),j=n(7),d=n.n(j),b=n(8),p=(n(21),"83.212.72.167:5000"),O=n(0),x=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={selectedNode:p},a.handleChange=a.handleChange.bind(Object(o.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(o.a)(a)),a}return Object(l.a)(n,[{key:"handleChange",value:function(e){this.setState({selectedNode:e.target.value})}},{key:"handleSubmit",value:function(e){var t="http://".concat(this.state.selectedNode,"/depart");this.state.selectedNode!==p?fetch(t).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)})):console.log("Cannot depart bootstrap node."),e.preventDefault()}},{key:"render",value:function(){var e=this.props.nodes.map((function(e){return"".concat(e.me.ip,":").concat(e.me.port)}));return Object(O.jsxs)("div",{className:"p-3",children:[Object(O.jsx)("h2",{children:"Depart"}),Object(O.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsx)("label",{children:"Select node"}),Object(O.jsx)("br",{}),Object(O.jsx)("select",{value:this.state.value,onChange:this.handleChange,children:e.map((function(e){return Object(O.jsx)("option",{value:e,children:e},e)}))})]}),Object(O.jsx)("input",{className:"btn btn-primary",type:"submit",value:"Depart"})]})]})}}]),n}(c.a.Component),v=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={key:"",value:"",node:p},a.onKeyChange=a.onKeyChange.bind(Object(o.a)(a)),a.onValueChange=a.onValueChange.bind(Object(o.a)(a)),a.onNodeChange=a.onNodeChange.bind(Object(o.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(o.a)(a)),a}return Object(l.a)(n,[{key:"onKeyChange",value:function(e){this.setState({key:e.target.value})}},{key:"onValueChange",value:function(e){this.setState({value:e.target.value})}},{key:"onNodeChange",value:function(e){this.setState({node:e.target.value})}},{key:"handleSubmit",value:function(e){var t="http://".concat(this.state.node,"/insert?key=").concat(this.state.key,"&value=").concat(this.state.value);console.log(t),fetch(t).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)})),e.preventDefault()}},{key:"render",value:function(){var e=this.props.nodes.map((function(e){return"".concat(e.me.ip,":").concat(e.me.port)}));return Object(O.jsxs)("div",{className:"p-3",children:[Object(O.jsx)("h2",{children:"Insert"}),Object(O.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsx)("label",{children:"Key"}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{type:"text",value:this.state.key,onChange:this.onKeyChange}),Object(O.jsx)("br",{}),Object(O.jsx)("label",{children:"Value"}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{type:"text",value:this.state.value,onChange:this.onValueChange}),Object(O.jsx)("br",{}),Object(O.jsx)("label",{children:"Node"}),Object(O.jsx)("br",{}),Object(O.jsx)("select",{value:this.state.node,onChange:this.onNodeChange,children:e.map((function(e){return Object(O.jsx)("option",{value:e,children:e},e)}))}),Object(O.jsx)("br",{})]}),Object(O.jsx)("input",{className:"btn btn-primary",type:"submit",value:"Insert"})]})]})}}]),n}(c.a.Component),m=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).nodes=e.nodes.map((function(e){return"".concat(e.me.ip,":").concat(e.me.port)})),a.state={key:"",node:p,value:"",printAll:!1,files:[]},a.onKeyChange=a.onKeyChange.bind(Object(o.a)(a)),a.onNodeChange=a.onNodeChange.bind(Object(o.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(o.a)(a)),a.handleClear=a.handleClear.bind(Object(o.a)(a)),a}return Object(l.a)(n,[{key:"onKeyChange",value:function(e){this.setState({key:e.target.value})}},{key:"onNodeChange",value:function(e){this.setState({node:e.target.value,value:"",files:[],printAll:!1})}},{key:"handleClear",value:function(e){this.setState({value:"",printAll:!1,files:[]})}},{key:"handleSubmit",value:function(e){var t=this,n="http://".concat(this.state.node,"/query?key=").concat(this.state.key);"*"===this.state.key?fetch(n).then((function(e){return e.json()})).then((function(e){var n=e.map((function(e){return e.files})).map((function(e){return Object.values(e)}));console.log(n),t.setState({value:"",files:n,printAll:!0})})).catch((function(e){return console.log(e)})):fetch(n).then((function(e){return e.json()})).then((function(e){t.setState({value:e.value,printAll:!1,files:[]})})).catch((function(e){return console.log(e)})),e.preventDefault()}},{key:"render",value:function(){var e=this.props.nodes.map((function(e){return"".concat(e.me.ip,":").concat(e.me.port)}));return Object(O.jsxs)("div",{className:"p-3",children:[Object(O.jsx)("h2",{children:"Query"}),Object(O.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsx)("label",{children:"Key"}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{type:"text",value:this.state.key,onChange:this.onKeyChange}),Object(O.jsx)("br",{}),Object(O.jsx)("label",{children:"Node"}),Object(O.jsx)("br",{}),Object(O.jsx)("select",{value:this.state.node,onChange:this.onNodeChange,children:e.map((function(e){return Object(O.jsx)("option",{value:e,children:e},e)}))})]}),Object(O.jsx)("input",{className:"btn btn-primary",type:"submit",value:"Query"})]}),this.state.value?Object(O.jsxs)("p",{className:"mt-3",children:[" Value: ",this.state.value," "]}):Object(O.jsx)("p",{children:"  "}),this.state.printAll?Object(O.jsxs)("div",{children:[this.state.files.map((function(e,t){return Object(O.jsxs)("div",{children:[Object(O.jsxs)("p",{children:[" ",Object(O.jsxs)("b",{children:["Node ",t]})," "]}),e.length?e.map((function(e){return Object(O.jsxs)("p",{children:["Key: ",e.name,Object(O.jsx)("br",{}),"Value: ",e.value]},e.name)})):Object(O.jsx)("p",{children:" No files "})]},t)})),Object(O.jsx)("button",{className:"btn btn-primary",onClick:this.handleClear,children:"Clear"})]}):Object(O.jsx)("p",{children:" "})]})}}]),n}(c.a.Component),f=n(14),y=function(e){var t=e.node,n=Object.values(t.files).map((function(e){return{key:e.name,value:e.value}})),a=t.replicas.map((function(e,t){var n=Object.keys(e);return n.length?n.map((function(t){return{key:e[t].name,value:e[t].value}})):[]}));return Object(O.jsxs)("div",{className:"mt-2",children:[Object(O.jsxs)("p",{children:[Object(O.jsx)("b",{children:"Files"}),":"]}),n.length?n.map((function(e){return Object(O.jsx)("div",{children:Object(O.jsxs)("p",{children:["Key: ",e.key," ",Object(O.jsx)("br",{}),"Value: ",e.value]})},e.key)})):Object(O.jsx)("p",{children:" No files "}),Object(O.jsxs)("p",{children:[Object(O.jsx)("b",{children:"Replicas"}),":"]}),a.map((function(e,t){return Object(O.jsxs)("div",{children:[Object(O.jsxs)("p",{children:[" ",Object(O.jsxs)("b",{children:["replica ",t]})," "]}),e.length?e.map((function(e){return Object(O.jsxs)("p",{children:["Key: ",e.key,Object(O.jsx)("br",{}),"Value: ",e.value]},e.key)})):Object(O.jsx)("p",{children:" No replicas "})]},t)}))]})},g=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={selectedNode:p,index:0,log:!1},a.handleChange=a.handleChange.bind(Object(o.a)(a)),a.handleClear=a.handleClear.bind(Object(o.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(o.a)(a)),a}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target.value.split(":"),n=Object(f.a)(t,2),a=n[0],c=n[1],s=this.props.nodes.findIndex((function(e){return e.me.ip===a&&e.me.port===parseInt(c)}));this.setState({selectedNode:e.target.value,index:s})}},{key:"handleClear",value:function(e){this.setState({log:!1})}},{key:"handleSubmit",value:function(e){this.setState({log:!0}),e.preventDefault()}},{key:"render",value:function(){var e=this.props.nodes.map((function(e){return"".concat(e.me.ip,":").concat(e.me.port)}));return Object(O.jsxs)("div",{className:"p-3",children:[Object(O.jsx)("h2",{children:"Log"}),Object(O.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsx)("label",{children:"Select node"}),Object(O.jsx)("br",{}),Object(O.jsx)("select",{value:this.state.selectedNode,onChange:this.handleChange,children:e.map((function(e,t){return Object(O.jsx)("option",{value:e,children:e},e)}))})]}),Object(O.jsx)("input",{className:"btn btn-primary",type:"submit",value:"Log"})]}),this.state.log?Object(O.jsxs)("div",{children:[Object(O.jsx)(y,{node:this.props.nodes[this.state.index]}),Object(O.jsx)("button",{className:"btn btn-primary",onClick:this.handleClear,children:"Clear"})]}):Object(O.jsx)("p",{children:" "})]})}}]),n}(c.a.Component),C=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={key:"",node:p},a.onKeyChange=a.onKeyChange.bind(Object(o.a)(a)),a.onNodeChange=a.onNodeChange.bind(Object(o.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(o.a)(a)),a}return Object(l.a)(n,[{key:"onKeyChange",value:function(e){this.setState({key:e.target.value})}},{key:"onNodeChange",value:function(e){this.setState({node:e.target.value})}},{key:"handleSubmit",value:function(e){var t="http://".concat(this.state.node,"/delete?key=").concat(this.state.key);fetch(t).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)})),e.preventDefault()}},{key:"render",value:function(){var e=this.props.nodes.map((function(e){return"".concat(e.me.ip,":").concat(e.me.port)}));return Object(O.jsxs)("div",{className:"p-3",children:[Object(O.jsx)("h2",{children:"Delete"}),Object(O.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(O.jsxs)("div",{className:"form-group",children:[Object(O.jsx)("label",{children:"Key"}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{type:"text",value:this.state.key,onChange:this.onKeyChange}),Object(O.jsx)("br",{}),Object(O.jsx)("label",{children:"Node"}),Object(O.jsx)("br",{}),Object(O.jsx)("select",{value:this.state.node,onChange:this.onNodeChange,children:e.map((function(e){return Object(O.jsx)("option",{value:e,children:e},e)}))})]}),Object(O.jsx)("input",{className:"btn btn-primary",type:"submit",value:"Delete"})]})]})}}]),n}(c.a.Component),N=function(e){return Object(O.jsxs)("div",{className:"p-3",children:[Object(O.jsxs)("h5",{children:[Object(O.jsx)("b",{children:"Number of replicas:"})," ",e.K]}),Object(O.jsxs)("h5",{children:[Object(O.jsx)("b",{children:"Consistency:"})," ",e.consistency]})]})},k=n(12),S=n.n(k);var K=function(e){if(e.nodes.length){var t=e.nodes.map((function(e){return"".concat(e.me.ip,":").concat(e.me.port)})),n=t.length,a=2*Math.PI/n;return Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{className:"text-center",children:"Network topology"}),Object(O.jsx)(S.a,{setup:function(e,t){e.createCanvas(500,500).parent(t)},draw:function(e){e.background("white"),e.circle(250,250,400);for(var c=0,s=0;s<n;s++){var r=250+200*Math.sin(c),i=250+200*Math.cos(c),l=t[s];e.circle(r,i,100),e.textAlign(e.CENTER,e.CENTER),e.textSize(10),e.text(l,r,i),c-=a}}}),Object(O.jsx)("button",{className:"btn btn-primary",onClick:e.handleReload,children:"Reload"})]})}return Object(O.jsx)("div",{children:Object(O.jsx)("h2",{className:"text-center",children:"Network topology"})})},w=n(13),R=n.n(w),D=n(10),F=n.n(D),V=function(e){var t=[],n=[],a=[],c=[];if(e.nodes.length){n=(t=(t=e.nodes.map((function(e){return{id:F()(e.me.id,16),label:"".concat(e.me.ip,":").concat(e.me.port)}}))).sort((function(e,t){return e.id-t.id}))).map((function(e){return e.label}));var s=F()("10000000000000000000000000000000000000000",16);a=t.map((function(e){return e.id})),(c=[]).push((a[0]+s-a[a.length-1])/s);for(var r=1;r<a.length;r++)c.push((a[r]-a[r-1])/s)}return Object(O.jsxs)("div",{className:"mt-4",children:[Object(O.jsx)("h2",{className:"text-center",children:"Key distribution"}),Object(O.jsx)(R.a,{data:[{type:"pie",values:c,labels:n}],layout:{width:500,height:500,paper_bgcolor:"#FFF0"}})]})},A=function(e){var t=e.nodes,n=e.K,a=e.consistency;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"row pt-3",children:[Object(O.jsx)("div",{className:"col",children:Object(O.jsx)(g,{nodes:t})}),Object(O.jsx)("div",{className:"col",children:Object(O.jsx)(x,{nodes:t})})]}),Object(O.jsxs)("div",{className:"row pt-3",children:[Object(O.jsx)("div",{className:"col",children:Object(O.jsx)(m,{nodes:t})}),Object(O.jsx)("div",{className:"col",children:Object(O.jsx)(C,{nodes:t})})]}),Object(O.jsxs)("div",{className:"row pt-3",children:[Object(O.jsx)("div",{className:"col",children:Object(O.jsx)(v,{nodes:t})}),Object(O.jsx)("div",{className:"col",children:Object(O.jsx)(N,{K:n,consistency:a})})]})]})},I=function(e){var t=e.nodes,n=e.handleReload;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{className:"row",children:Object(O.jsx)(K,{nodes:t,handleReload:n})}),Object(O.jsx)("div",{className:"row mt-5",children:Object(O.jsx)(V,{nodes:t})})]})},T=function(){var e=Object(b.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(p,"/consistency"));case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",{K:n.K,consistency:n.consistency});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(b.a)(d.a.mark((function e(){var t,n,a,c,s,r,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t=p,a=[],c=0;case 4:return s="http://".concat(n,"/log"),e.next=8,fetch(s);case 8:return r=e.sent,e.next=11,r.json();case 11:if(i=e.sent,a.push(i),(n="".concat(i.next.ip,":").concat(i.next.port))!==t&&a){e.next=16;break}return e.abrupt("break",22);case 16:if(!((c+=1)>10)){e.next=20;break}return console.log("Too many nodes to handle..."),e.abrupt("break",22);case 20:e.next=4;break;case 22:return e.abrupt("return",a);case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={nodes:[],K:0,consistency:"linearizability"},a.handleReload=a.handleReload.bind(Object(o.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(b.a)(d.a.mark((function e(){var t,n,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:return t=e.sent,n=t.K,a=t.consistency,e.next=7,E();case 7:c=e.sent,this.setState({nodes:c,K:n,consistency:a});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleReload",value:function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:n=e.sent,this.setState({nodes:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(O.jsxs)("div",{className:"app container-fluid w-100 d-inline-block",children:[Object(O.jsx)("h1",{className:"main-heading text-center mt-4 p-3",children:"ToyChord"}),Object(O.jsx)("div",{className:"p-4",children:Object(O.jsxs)("div",{className:"row",children:[Object(O.jsx)("div",{className:"col",children:Object(O.jsx)(I,{nodes:this.state.nodes,handleReload:this.handleReload})}),Object(O.jsx)("div",{className:"col",children:Object(O.jsx)(A,{nodes:this.state.nodes,K:this.state.K,consistency:this.state.consistency})})]})})]})}}]),n}(c.a.Component),L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,42)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))};r.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(M,{})}),document.getElementById("root")),L()}},[[41,1,2]]]);
//# sourceMappingURL=main.3c8fa56e.chunk.js.map